<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FluentBiz â€” Smart Business Dashboard</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* ===== BASIC STYLE ===== */
    :root{
      --purple:#6C63FF;
      --blue:#2575FC;
      --bg:#f6f7fb;
      --card:#ffffff;
      --muted:#6b7280;
      --glass: rgba(255,255,255,0.7);
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;}
    body{margin:0;background:linear-gradient(180deg,#eef2ff,#f8fafc);color:#0f172a;min-height:100vh}
    a{color:inherit;text-decoration:none}

    /* container */
    .wrap{max-width:1100px;margin:24px auto;padding:20px}

    /* nav */
    nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .brand{font-weight:700;color:var(--purple);font-size:20px}
    .lang-switch button{margin-left:8px;padding:6px 10px;border-radius:8px;border:0;background:transparent;cursor:pointer}
    .lang-switch .active{background:#eef1ff;color:var(--blue);box-shadow:0 4px 12px rgba(39,55,230,0.06)}

    /* page sections (SPA) */
    section.page{display:none;opacity:0;transform:translateY(8px);transition:all .35s ease;min-height:60vh}
    section.page.active{display:block;opacity:1;transform:none}

    /* hero */
    .hero{display:flex;gap:20px;align-items:center;justify-content:space-between;padding:28px;border-radius:14px;background:linear-gradient(135deg,var(--purple),var(--blue));color:white}
    .hero .left{flex:1}
    .hero h1{font-size:28px;margin:0 0 8px}
    .hero p{margin:0;color:rgba(255,255,255,0.9)}
    .cta{margin-top:18px}

    .btn{padding:10px 16px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    .btn-primary{background:white;color:var(--purple)}
    .btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.18);color:white}

    /* card */
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 24px rgba(15,23,42,0.06);color:#0f172a}

    /* login */
    .center{max-width:420px;margin:20px auto}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid #e6eefc;margin-bottom:12px}

    /* dashboard layout */
    .grid-3{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .stat{padding:14px;border-radius:12px;background:linear-gradient(90deg,#fff,#fbfbff);text-align:center}
    .stat h4{color:var(--muted);margin:0 0 8px}
    .stat p{font-weight:700;color:var(--purple);margin:0}

    /* small table */
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #f1f3f8;text-align:left;font-size:14px}
    th{background:#fbfdff;color:var(--purple)}

    /* overlay/modal */
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(12,18,30,0.45);z-index:60}
    .overlay.show{display:flex}
    .modal{background:white;padding:20px;border-radius:12px;max-width:480px;width:90%}

    /* footer */
    footer{text-align:center;color:var(--muted);margin-top:30px;padding-bottom:40px}

    /* responsive */
    @media (max-width:820px){
      .hero{flex-direction:column;text-align:center}
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- NAV -->
    <nav>
      <div class="brand">FluentBiz</div>
      <div style="display:flex;align-items:center;gap:12px">
        <div class="lang-switch" aria-hidden>
          <button id="btnID" class="active">ID</button>
          <button id="btnEN">EN</button>
        </div>
        <button id="gotoLogin" class="btn btn-primary">Get Started</button>
      </div>
    </nav>

    <!-- HOME -->
    <section id="home" class="page active">
      <div class="hero">
        <div class="left">
          <div style="font-weight:700;margin-bottom:8px">Satu Dashboard untuk Semua Bisnis Anda ðŸš€</div>
          <h1>FluentBiz â€” Smart Business Dashboard for Global Growth</h1>
          <p id="home-desc">Kelola semua aktivitas bisnis kamu dari satu tempat. FluentBiz membantu seller online, perusahaan kecil, hingga korporasi besar memantau penjualan, performa, dan laporan keuangan secara otomatis.</p>

          <div class="cta">
            <button id="startBtn" class="btn btn-primary">Mulai Sekarang</button>
            <button id="demoBtn" class="btn btn-outline">Lihat Demo Dashboard</button>
          </div>
        </div>
        <div style="min-width:300px;max-width:360px">
          <div class="card">
            <h3 style="margin:0 0 8px">Visi & Misi</h3>
            <p style="color:var(--muted);margin-bottom:8px"><strong>Visi:</strong> Membangun ekosistem digital global yang membantu bisnis tumbuh cerdas dan efisien.</p>
            <p style="color:var(--muted)"><strong>Misi:</strong> Menyediakan solusi analitik terpadu bagi perusahaan, UMKM, dan seller online untuk meningkatkan penjualan, efisiensi, dan kolaborasi global.</p>
          </div>
        </div>
      </div>

      <!-- Features -->
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-top:18px">
        <div class="card">
          <h4>Untuk Seller Online</h4>
          <p style="color:var(--muted)">Sinkron marketplace, pantau order & stok, dan optimalkan listing Anda.</p>
        </div>
        <div class="card">
          <h4>Untuk Perusahaan</h4>
          <p style="color:var(--muted)">Pusatkan laporan, gabungkan data multi-cabang, dan visualisasikan KPI instan.</p>
        </div>
        <div class="card">
          <h4>Untuk Aplikasi & Platform</h4>
          <p style="color:var(--muted)">Integrasi API untuk analyticsâ€”game, sosial media, pembayaran, dan platform lainnya.</p>
        </div>
      </div>
    </section>

    <!-- LOGIN -->
    <section id="auth" class="page">
      <div class="center card">
        <h2 id="auth-title">Masuk ke FluentBiz</h2>
        <p id="auth-sub" style="color:var(--muted);margin-bottom:12px">Gunakan email & password untuk membuat akun dan mencoba trial 7 hari.</p>

        <label for="email">Email</label>
        <input id="email" type="email" placeholder="email@domain.com" />

        <label for="password">Password</label>
        <input id="password" type="password" placeholder="Minimal 6 karakter" />

        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="loginBtn" class="btn btn-primary" style="flex:1">Login</button>
          <button id="registerBtn" class="btn" style="flex:1;background:#eef1ff;color:var(--blue)">Daftar</button>
        </div>

        <p id="auth-msg" style="color:crimson;margin-top:10px;display:none"></p>
        <p style="color:var(--muted);font-size:13px;margin-top:12px">Atau lihat demo tanpa akun</p>
        <div style="text-align:center;margin-top:8px">
          <button id="demoNoAuth" class="btn btn-outline">Lihat Demo</button>
        </div>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboard" class="page">
      <div style="display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:14px">
        <h2 style="margin:0">Dashboard</h2>
        <div style="display:flex;gap:10px;align-items:center">
          <div style="color:var(--muted);font-size:14px">Trial: <span id="trialDays">â€”</span></div>
          <button id="connectShop" class="btn btn-outline">Connect Shopee</button>
          <button id="logout" class="btn" style="background:#fff;color:var(--blue)">Logout</button>
        </div>
      </div>

      <div class="grid-3" style="margin-bottom:14px">
        <div class="stat card"><h4>Total Sales</h4><p id="statSales">â€”</p></div>
        <div class="stat card"><h4>Active Customers</h4><p id="statUsers">â€”</p></div>
        <div class="stat card"><h4>Revenue</h4><p id="statRevenue">â€”</p></div>
      </div>

      <div class="card" style="margin-bottom:12px">
        <h3 style="margin:0 0 12px">Sales (Last 8 months)</h3>
        <canvas id="salesChart"></canvas>
      </div>

      <div class="card">
        <h3 style="margin:0 0 12px">User Growth</h3>
        <canvas id="userChart"></canvas>
      </div>

      <div style="margin-top:12px">
        <h4>Recent Transactions</h4>
        <div class="card">
          <table>
            <thead><tr><th>ID</th><th>Date</th><th>Customer</th><th>Total</th></tr></thead>
            <tbody id="txnBody">
              <!-- populated by JS -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer>
      Â© 2025 FluentBiz â€¢ Built for Sellers, Companies & Platforms
    </footer>
  </div>

  <!-- MODAL TRIAL EXPIRED -->
  <div id="modal" class="overlay">
    <div class="modal">
      <h3>Trial Anda Telah Berakhir</h3>
      <p style="color:var(--muted)">Masa trial 7 hari telah habis. Untuk melanjutkan, silakan aktifkan langganan premium.</p>
      <div style="display:flex;gap:10px;margin-top:12px;justify-content:flex-end">
        <button id="closeModal" class="btn" style="background:#eef1ff;color:var(--blue)">Tutup</button>
        <button id="subscribeBtn" class="btn btn-primary">Langganan Sekarang</button>
      </div>
    </div>
  </div>

  <!-- ===== JAVASCRIPT: Firebase + App Logic ===== -->
  <script type="module">
    // ---------- FIREBASE CONFIG (from your project)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAH2GlmyCDTF2RfEnMVEsBjfO7flINEcA8",
      authDomain: "fluentbizapp01.firebaseapp.com",
      projectId: "fluentbizapp01",
      storageBucket: "fluentbizapp01.firebasestorage.app",
      messagingSenderId: "5394474895",
      appId: "1:5394474895:web:f96a1a1d43425cb0cccdfa",
      measurementId: "G-VGY05PD58S"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // ---------- SMALL i18n (ID / EN)
    const texts = {
      en: {
        homeDesc: "Manage and analyze your business from one place. FluentBiz helps sellers, small companies, and large enterprises monitor sales, performance, and finance automatically.",
        getStarted: "Get Started",
        demo: "View Demo Dashboard",
        authTitle: "Sign in to FluentBiz",
        authSub: "Use email & password to access a 7-day trial account.",
        login: "Login",
        register: "Register",
        trialExpiredTitle: "Your trial has ended",
        trialExpiredText: "Your 7-day trial expired. Please subscribe to continue."
      },
      id: {
        homeDesc: "Kelola semua aktivitas bisnis kamu dari satu tempat. FluentBiz membantu seller online, perusahaan kecil, hingga korporasi besar memantau penjualan, performa, dan laporan keuangan secara otomatis.",
        getStarted: "Mulai Sekarang",
        demo: "Lihat Demo Dashboard",
        authTitle: "Masuk ke FluentBiz",
        authSub: "Gunakan email & password untuk mengakses trial 7 hari.",
        login: "Login",
        register: "Daftar",
        trialExpiredTitle: "Trial Anda Telah Berakhir",
        trialExpiredText: "Masa trial 7 hari telah habis. Untuk melanjutkan, silakan aktifkan langganan premium."
      }
    };

    let lang = localStorage.getItem('fluent_lang') || 'id';
    const applyLang = () => {
      const t = texts[lang];
      document.getElementById('home-desc').textContent = t.homeDesc;
      document.getElementById('startBtn').textContent = t.getStarted;
      document.getElementById('demoBtn').textContent = t.demo;
      document.getElementById('auth-title').textContent = t.authTitle;
      document.getElementById('auth-sub').textContent = t.authSub;
      document.getElementById('loginBtn').textContent = t.login;
      document.getElementById('registerBtn').textContent = t.register;
      // modal text
      document.querySelector('#modal h3').textContent = t.trialExpiredTitle;
      document.querySelector('#modal p').textContent = t.trialExpiredText;
    };

    // lang buttons
    const btnID = document.getElementById('btnID');
    const btnEN = document.getElementById('btnEN');
    btnID.addEventListener('click',()=>{lang='id';localStorage.setItem('fluent_lang','id');btnID.classList.add('active');btnEN.classList.remove('active');applyLang()});
    btnEN.addEventListener('click',()=>{lang='en';localStorage.setItem('fluent_lang','en');btnEN.classList.add('active');btnID.classList.remove('active');applyLang()});
    if(lang==='id'){btnID.classList.add('active');btnEN.classList.remove('active')}else{btnEN.classList.add('active');btnID.classList.remove('active')}
    applyLang();

    // ---------- NAVIGATION (single page)
    const showPage = id => {
      document.querySelectorAll('section.page').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      window.scrollTo({top:0,behavior:'smooth'});
    };

    document.getElementById('startBtn').addEventListener('click',()=>showPage('auth'));
    document.getElementById('gotoLogin').addEventListener('click',()=>showPage('auth'));
    document.getElementById('demoBtn').addEventListener('click',()=>{ showPage('dashboard'); loadDemoData(); });
    document.getElementById('demoNoAuth').addEventListener('click',()=>{ showPage('dashboard'); loadDemoData(); });

    // ---------- AUTH (register/login)
    const emailInput = document.getElementById('email');
    const passInput = document.getElementById('password');
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const authMsg = document.getElementById('auth-msg');

    loginBtn.addEventListener('click', async ()=>{
      authMsg.style.display='none';
      const email = emailInput.value.trim(), pass = passInput.value.trim();
      if(!email || !pass){ authMsg.textContent='Please provide email & password.'; authMsg.style.display='block'; return; }
      try {
        await signInWithEmailAndPassword(auth,email,pass);
        // onAuthStateChanged handles redirect
      } catch(e){
        authMsg.textContent = e.message;
        authMsg.style.display='block';
      }
    });

    registerBtn.addEventListener('click', async ()=>{
      authMsg.style.display='none';
      const email = emailInput.value.trim(), pass = passInput.value.trim();
      if(!email || !pass){ authMsg.textContent='Please provide email & password.'; authMsg.style.display='block'; return; }
      try {
        const cred = await createUserWithEmailAndPassword(auth,email,pass);
        // create user doc with trial start
        const uid = cred.user.uid;
        await setDoc(doc(db,'users',uid),{
          email: email,
          trialStart: serverTimestamp(),
          // trialActive: true // can infer from date
        });
        // redirect handled by onAuthStateChanged
      } catch(e){
        authMsg.textContent = e.message;
        authMsg.style.display='block';
      }
    });

    // ---------- AUTH STATE & TRIAL CHECK
    onAuthStateChanged(auth, async user => {
      if(user){
        // get user doc
        const udoc = await getDoc(doc(db,'users',user.uid));
        let trialStart = null;
        if(udoc.exists()){
          const data = udoc.data();
          trialStart = data.trialStart?.toDate ? data.trialStart.toDate() : (data.trialStart ? new Date(data.trialStart) : null);
        } else {
          // if no doc (e.g. created elsewhere) create one
          await setDoc(doc(db,'users',user.uid),{ email:user.email, trialStart: serverTimestamp() });
        }

        // compute days left
        let daysLeft = 'â€”';
        if(trialStart){
          const now = new Date();
          const diff = Math.floor((now - trialStart) / (1000 * 60 * 60 * 24));
          const left = 7 - diff;
          if(left <= 0){
            // trial expired
            daysLeft = 0;
            showModal();
            showPage('dashboard'); // still show but disabled functions maybe
          } else {
            daysLeft = left;
          }
        } else {
          daysLeft = 7;
        }

        document.getElementById('trialDays').textContent = daysLeft + ' day(s)';
        // populate dashboard with real or demo data
        loadDemoData(); // later we will load real data from APIs
        showPage('dashboard');
      } else {
        // not logged in
        document.getElementById('trialDays').textContent = 'â€”';
      }
    });

    // logout
    document.getElementById('logout').addEventListener('click', async ()=>{
      await signOut(auth);
      showPage('home');
    });

    // ---------- Demo data + Chart rendering
    let salesChart=null, userChart=null;
    function loadDemoData(){
      // sample numbers (could be replaced by Firestore queries later)
      const sales = [12000,15000,18000,22000,26000,31000,37000,42500];
      const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug'];
      const users = [120,200,340,480,560,700,820,960];

      document.getElementById('statSales').textContent = sales.reduce((a,b)=>a+b,0).toLocaleString();
      document.getElementById('statUsers').textContent = users[users.length-1].toLocaleString();
      document.getElementById('statRevenue').textContent = 'Rp ' + sales[sales.length-1].toLocaleString();

      // transactions sample
      const txns = [
        {id:'#001',date:'01 Oct 2025',customer:'Andi',total:'Rp 2.000.000'},
        {id:'#002',date:'02 Oct 2025',customer:'Bella',total:'Rp 1.800.000'},
        {id:'#003',date:'03 Oct 2025',customer:'Citra',total:'Rp 2.500.000'}
      ];
      const tbody = document.getElementById('txnBody');
      tbody.innerHTML = txns.map(t => `<tr><td>${t.id}</td><td>${t.date}</td><td>${t.customer}</td><td>${t.total}</td></tr>`).join('');

      // create charts
      const sctx = document.getElementById('salesChart').getContext('2d');
      if(salesChart) salesChart.destroy();
      salesChart = new Chart(sctx,{ type:'line', data:{ labels:months, datasets:[{label:'Sales (Rp)', data:sales, borderColor: 'rgba(108,99,255,0.95)', backgroundColor:'rgba(108,99,255,0.12)', tension:0.3, fill:true}]}, options:{responsive:true,scales:{y:{beginAtZero:true}}}});

      const uctx = document.getElementById('userChart').getContext('2d');
      if(userChart) userChart.destroy();
      userChart = new Chart(uctx,{ type:'bar', data:{ labels:months, datasets:[{label:'Active Users', data:users, backgroundColor:'rgba(37,117,252,0.9)'}]}, options:{responsive:true,scales:{y:{beginAtZero:true}}}});
    }

    // ---------- Modal (trial expired)
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const subscribeBtn = document.getElementById('subscribeBtn');
    function showModal(){ modal.classList.add('show'); }
    function hideModal(){ modal.classList.remove('show'); }
    closeModal.addEventListener('click',hideModal);
    subscribeBtn.addEventListener('click',()=>{
      // placeholder: you can later redirect to subscription page / payment flow
      window.alert('Redirect to subscription / payment (to be implemented)');
    });

    // ---------- Connect Shopee (placeholder ready for real integration)
    document.getElementById('connectShop').addEventListener('click', ()=>{
      // real flow: redirect to Shopee partner auth URL or open OAuth via backend
      alert('Hubungkan Shopee: fitur integrasi nyata akan memerlukan pendaftaran Shopee Developer & backend. Saat ini ini adalah demo.');
    });

    // ---------- quick demo login (optional convenience)
    // if you want to auto-fill test credentials in dev, uncomment below:
    // emailInput.value = 'test@example.com';
    // passInput.value = '123456';

    // ---------- keyboard Enter support
    passInput.addEventListener('keyup', e => { if(e.key === 'Enter') loginBtn.click() });

    // init
    applyLang();
  </script>
</body>
</html>
